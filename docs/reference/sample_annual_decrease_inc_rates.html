<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Samples the Percentage Annual Decrease Based On Incidence Rates — sample_annual_decrease_inc_rates • Reassessing the Evidence for Universal School-age BCG in England and Wales</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Samples the Percentage Annual Decrease Based On Incidence Rates — sample_annual_decrease_inc_rates" />

<meta property="og:description" content="This function samples the percentage annual decrease, using Sutherland et al's estimates for
White UK born incidence rates and estimates of UK born incidence rates  in England calculated using the Enhanced Tuberculosis
surveilliance system and the Labour Force Survey. Incidence rates are first sampled from the estimated UK born incidence rates,
by assuming that they are normally distributed. Incidence rates are then sampled from the Sutherland et al. estimates from 1973, 1978, and 1983
using sample_incidence_rates. Average incidence rates for all cases are then estimated using Sutherland
et al.'s population weights for those BCG vaccinated (75
incidence rates are then estimated using a loess fit for each sample, with samples predicted to have an incidence rate below 0.1 per 100,000
having this set to be 0.1 per 100,000. The percentage annual difference is the calculated for each sample
using   sample_per_decrease. Projected annual percentage changes are estimated using an average of
the previous 3 years. Similarly for years prior to Sutherland et als incidence rate estimates an average of the previous 3 years are used.
Samples of the percentage annual decrease are returned as a tibble, containing the nested dataframe and a nested matrix ready to be used by
sutherland_model." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Reassessing the Evidence for Universal School-age BCG in England and Wales</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/analysis_plan.html">Analysis Plan</a>
</li>
<li>
  <a href="../articles/paper.html">Paper + SI</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/seabbs/AssessBCGPolicyChange">
    <span class="fa fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Samples the Percentage Annual Decrease Based On Incidence Rates</h1>
    <small class="dont-index">Source: <a href='https://github.com/seabbs/AssessBCGPolicyChange/blob/master/R/sample_annual_decrease_inc_rates.R'><code>R/sample_annual_decrease_inc_rates.R</code></a></small>
    <div class="hidden name"><code>sample_annual_decrease_inc_rates.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function samples the percentage annual decrease, using Sutherland et al's estimates for
White UK born incidence rates and estimates of UK born incidence rates  in England calculated using the Enhanced Tuberculosis
surveilliance system and the Labour Force Survey. Incidence rates are first sampled from the estimated UK born incidence rates,
by assuming that they are normally distributed. Incidence rates are then sampled from the Sutherland et al. estimates from 1973, 1978, and 1983
using <code><a href='sample_incidence_rates.html'>sample_incidence_rates</a></code>. Average incidence rates for all cases are then estimated using Sutherland
et al.'s population weights for those BCG vaccinated (75<!-- %), unvaccinated (11%), tuberculin positive (8%) and ineligible (6%). Missing -->
incidence rates are then estimated using a loess fit for each sample, with samples predicted to have an incidence rate below 0.1 per 100,000
having this set to be 0.1 per 100,000. The percentage annual difference is the calculated for each sample
using  <code> sample_per_decrease</code>. Projected annual percentage changes are estimated using an average of
the previous 3 years. Similarly for years prior to Sutherland et als incidence rate estimates an average of the previous 3 years are used.
Samples of the percentage annual decrease are returned as a tibble, containing the nested dataframe and a nested matrix ready to be used by
<code><a href='sutherland_model.html'>sutherland_model</a></code>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sample_annual_decrease_inc_rates</span>(<span class='kw'>samples</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>TB_cohorts</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"15-19 years"</span>, <span class='st'>"20-24 years"</span>, <span class='st'>"25-29 years"</span>),
  <span class='kw'>max_year</span> <span class='kw'>=</span> <span class='fl'>2023</span>, <span class='kw'>min_year</span> <span class='kw'>=</span> <span class='fl'>1969</span>, <span class='kw'>years_to_avg</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>samples</th>
      <td><p>Numeric, the number of samples to take. Defaults to 10.</p></td>
    </tr>
    <tr>
      <th>TB_cohorts</th>
      <td><p>A character vector indicating the names of the cohorts modelled. Defaults to 15-19 years, 20-24 years, and 25-29 years.</p></td>
    </tr>
    <tr>
      <th>max_year</th>
      <td><p>Numeric, set as greater than the maximum year in the dataframe if interested in projection.
Defaults to <code>NULL</code>. If specified, then an average of the percentage decrease for a set number
of years is taken. This is specified with <code>years_to_avg</code>.</p></td>
    </tr>
    <tr>
      <th>years_to_avg</th>
      <td><p>Numeric, the number of years over which to average the percentage decrease
when estimating the ongoing percentage decrease.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical, defaults to <code>TRUE</code>. Should summary measures and plots be returned.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A nested tibble, containing the sample number, and both a nested dataframe and nested matrix of
annual percentage changes.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>sample_per_decrease sample_annual_decrease_nots</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>sample_annual_decrease_inc_rates</span>(<span class='kw'>samples</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='message'>Loess fit uses 1000 sampled data points</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 750 rows containing non-finite values (stat_binhex).</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Computation failed in `stat_binhex()`:</span>
#&gt; <span class='warning'>Package `hexbin` required for `stat_binhex`.</span>
#&gt; <span class='warning'>Please install and try again.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Computation failed in `stat_binhex()`:</span>
#&gt; <span class='warning'>Package `hexbin` required for `stat_binhex`.</span>
#&gt; <span class='warning'>Please install and try again.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Computation failed in `stat_binhex()`:</span>
#&gt; <span class='warning'>Package `hexbin` required for `stat_binhex`.</span>
#&gt; <span class='warning'>Please install and try again.</span></div><div class='output co'>#&gt; <span class='message'>`geom_smooth()` using formula 'y ~ x'</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 582 rows containing non-finite values (stat_smooth).</span></div><div class='output co'>#&gt; <span class='error'>Error in create_cluster(cores = cores): could not find function "create_cluster"</span></div><div class='img'><img src='sample_annual_decrease_inc_rates-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sam Abbott.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

